# VS-YueDu

一个现代化的VS Code插件，提供侧边栏界面让用户在终端中阅读本地文件。

## 功能特点

- 📁 添加本地文件到阅读列表
- 📖 在集成终端中分页阅读文件内容
- 📑 智能章节识别和按章节阅读
- 🖥️ 侧边栏树形视图，直观管理文件和章节
- 🗑️ 管理阅读列表（添加/移除文件）
- 🖱️ 支持右键菜单快速添加文件
- 🎯 点击章节即可在终端中阅读

## 使用方法

### 安装插件

1. 打开VS Code
2. 点击左侧扩展图标（或按 `Ctrl+Shift+X` / `Cmd+Shift+X`）
3. 搜索"VS-YueDu"
4. 点击安装

### 添加文件到阅读列表

1. **右键菜单方式**：
   - 在资源管理器中右键点击任意文件
   - 选择"VS-YueDu: 添加文件到阅读列表"

2. **拖拽方式**：
   - 直接将文件拖拽到侧边栏的"VS-YueDu"视图中

3. **设置界面配置**：
   - 打开VS Code设置（`Ctrl/Cmd + ,`）
   - 搜索"VS-YueDu"
   - 在"阅读列表"中添加文件路径和自定义名称
   - 支持批量添加、删除或修改文件配置

### 使用侧边栏阅读

1. **打开侧边栏**:
   - 点击左侧活动栏中的📖图标
   - 或按 `Ctrl+Shift+E` / `Cmd+Shift+E` 打开资源管理器，选择"VS-YueDu"

2. **浏览文件**:
   - 侧边栏会显示所有已添加的文件
   - 点击文件名左侧的展开图标查看章节

3. **阅读章节**:
   - 点击任意章节即可在"输出"面板中阅读该章节内容

4. **跳转到上次阅读位置**:
   - 在侧边栏中右键点击文件
   - 选择"跳转到上次阅读位置"即可直接跳转到该文件的上次阅读章节

### 配置格式说明

**正确的配置格式**（在VS Code设置中）：
```json
{
    "vs-yuedu.readingList": [
        {
            "filePath": "/Users/username/Documents/novel.txt",
            "displayName": "我的小说",
            "lastReadChapter": "第一章",
            "lastReadLine": 0
        },
        {
            "filePath": "/Users/username/Documents/technical-book.md"
        }
    ]
}
```

### 阅读记录功能

- **自动记录**：每次阅读章节时自动记录当前阅读的章节和行号
- **进度显示**：在阅读列表中显示最后阅读的章节（📖图标标记）
- **持久保存**：阅读记录会保存在配置文件中，重启VS Code后依然有效
- **智能同步**：通过VS Code设置界面和配置文件实时同步阅读记录

### 故障排查

如果文件未显示在列表中：
1. **检查文件路径**：确保文件路径正确且文件存在
2. **检查配置格式**：使用上述正确格式
3. **重启VS Code**：配置更改后可能需要重启
4. **查看控制台**：打开开发者工具查看错误日志
5. **使用右键添加**：通过右键菜单添加文件更简单可靠
   - 内容会显示在"VS-YueDu"输出通道中，包含行号和完整章节内容

4. **章节导航**:
   - **上一章**: `Ctrl+Shift+Alt+P` (Mac: `Cmd+Shift+Alt+P`)
   - **下一章**: `Ctrl+Shift+Alt+N` (Mac: `Cmd+Shift+Alt+N`)
   - **老板键**: `Ctrl+Shift+Alt+T` (Mac: `Cmd+Shift+Alt+T`) - 快速切换到终端
   - **跳转到上次阅读位置**: `Ctrl+Shift+Alt+L` (Mac: `Cmd+Shift+Alt+L`) - 一键回到上次阅读的章节

5. **管理文件**:
   - 通过VS Code设置界面管理：可以批量添加、删除或修改文件配置
   - 点击顶部刷新按钮可以刷新列表

### 章节识别

插件会自动识别以下格式的章节标题：
- 第X章、第X节、第X篇
- 数字+点/顿号：1. 2、 3.
- Markdown标题：# ## ###
- 英文章节：Chapter 1, Section 1
- 分隔线格式：=== ---

### 章节阅读
- **完整显示**：每个章节内容完整展示，无需分页
- **章节标识**：章节列表清晰显示章节标题和编号
- **行号显示**：每行内容附带原始文件行号
- **格式优化**：清晰的章节标题和文件信息展示

### 随机代码模式（可配置）
- **开关配置**：在VS Code设置中开启/关闭
- **比例调节**：可设置随机代码占比（10%-80%），表示每行正文对应的掩饰代码行数
- **展示逻辑**：根据配置的百分比，每行正文内容后会插入对应数量的掩饰代码
- **运行日志格式**：掩饰代码以Java/JS运行日志形式呈现，如 `[2024-01-15 14:30:25] INFO DatabaseManager: initialized successfully`
- **清晰标识**：运行日志用📊图标标记，正文内容用📄图标标记
- **配置路径**：设置 → 扩展 → VS-YueDu → 随机代码模式

## 开发指南

### 环境要求

- Node.js 16.x 或更高版本
- VS Code 1.74.0 或更高版本

### 构建和运行

```bash
# 安装依赖
npm install

# 编译项目
npm run compile

# 在调试模式下运行
按 F5 打开新的扩展开发主机窗口
```

### 打包发布

```bash
# 安装 vsce
npm install -g vsce

# 打包扩展
vsce package
```

## 文件结构

```
vs-yuedu/
├── src/
│   ├── extension.ts          # 插件主入口文件
│   ├── fileConfig.ts        # 配置文件管理器
│   └── treeDataProvider.ts   # 树形数据提供器
├── package.json              # 插件配置文件
├── tsconfig.json            # TypeScript配置
├── .gitignore               # Git忽略文件
├── CHANGELOG.md             # 版本更新日志
├── LICENSE.txt              # 许可证文件
└── README.md                # 项目说明文档
```

## 许可证

MIT License